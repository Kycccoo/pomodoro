import{u as $}from"./list-48d1dc0e.js";import{u as z}from"./settings-9bde03b6.js";import{g as J,o as K,a as F,n as Q,u as x,b as W,r as C,w as X,c as I,_ as Y,s as L,d as P,e as Z,f as m,V as ee,h as f,i as y,j as M,k as G,F as j,t as B,l as E,m as te,p as ne,q as oe,v as se}from"./index-0c9d1eb6.js";import{V as h,a as re}from"./VRow-4307cbf6.js";function U(e){return J()?(K(e),!0):!1}function A(){const e=new Set,t=n=>{e.delete(n)};return{on:n=>{e.add(n);const r=()=>t(n);return U(r),{off:r}},off:t,trigger:(...n)=>Promise.all(Array.from(e).map(r=>r(...n)))}}function q(e){return typeof e=="function"?e():x(e)}const ae=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ie=Object.prototype.toString,le=e=>ie.call(e)==="[object Object]",ce=()=>{};function ue(e){return e||W()}function fe(e,t=!0,o){const s=ue(o);s?F(e,s):t?e():Q(e)}function de(e){var t;const o=q(e);return(t=o==null?void 0:o.$el)!=null?t:o}const D=ae?window:void 0;function pe(...e){let t,o,s,n;if(typeof e[0]=="string"||Array.isArray(e[0])?([o,s,n]=e,t=D):[t,o,s,n]=e,!t)return ce;Array.isArray(o)||(o=[o]),Array.isArray(s)||(s=[s]);const r=[],a=()=>{r.forEach(u=>u()),r.length=0},S=(u,c,i,l)=>(u.addEventListener(c,i,l),()=>u.removeEventListener(c,i,l)),T=X(()=>[de(t),q(n)],([u,c])=>{if(a(),!u)return;const i=le(c)?{...c}:c;r.push(...o.flatMap(l=>s.map(_=>S(u,l,_,i))))},{immediate:!0,flush:"post"}),b=()=>{T(),a()};return U(b),b}function ve(){const e=C(!1);return W()&&F(()=>{e.value=!0}),e}function me(e){const t=ve();return I(()=>(t.value,!!e()))}function ge(e={}){const{window:t=D,requestPermissions:o=!0}=e,s=e,n=me(()=>!!t&&"Notification"in t),r=C(n.value&&"permission"in Notification&&Notification.permission==="granted"),a=C(null),S=async()=>{if(n.value)return!r.value&&Notification.permission!=="denied"&&await Notification.requestPermission()==="granted"&&(r.value=!0),r.value},{on:T,trigger:b}=A(),{on:u,trigger:c}=A(),{on:i,trigger:l}=A(),{on:_,trigger:N}=A(),O=async g=>{if(!n.value||!r.value)return;const w=Object.assign({},s,g);return a.value=new Notification(w.title||"",w),a.value.onclick=b,a.value.onshow=c,a.value.onerror=l,a.value.onclose=N,a.value},k=()=>{a.value&&a.value.close(),a.value=null};if(o&&fe(S),U(k),n.value&&t){const g=t.document;pe(g,"visibilitychange",w=>{w.preventDefault(),g.visibilityState==="visible"&&k()})}return{isSupported:n,notification:a,ensurePermissions:S,permissionGranted:r,show:O,close:k,onClick:T,onShow:u,onError:i,onClose:_}}const H=e=>(oe("data-v-534a2156"),e=e(),se(),e),_e={id:"tablex"},he=H(()=>y("h1",null,"待辦事項",-1)),ye={style:{"text-decoration":"underline"}},Se=H(()=>y("h1",null,"剩餘時間",-1)),be={style:{"text-decoration":"underline"}},we={__name:"HomeView",setup(e){const t=$(),{currentItem:o,items:s,timeleft:n}=L(t),{setCurrentItem:r,countdown:a,setFinishedItem:S}=t,T=z(),{selectedAlarmFile:b,notify:u}=L(T),c=C(Array.from({length:26},()=>Array(60).fill(!1))),i={STOP:0,COUNTING:1,PAUSE:2},l=C(i.STOP);let _=0;const N=()=>{l.value===i.STOP&&s.value.length>0&&r(),l.value=i.COUNTING,_=setInterval(()=>{a();const d=Math.floor(n.value/60),p=n.value%60;c.value[d][p]=!0,n.value===0&&g()},1e3)},O=I(()=>{const d=[];for(let p=0;p<26;p++)for(let v=0;v<60;v++)d.push({"background-color":c.value[p][v]?"#fff":"#216e39"});return d}),k=()=>{l.value=i.PAUSE,clearInterval(_)},g=()=>{clearInterval(_),l.value=i.STOP;const d=new Audio;if(d.src=b.value,d.play(),u.value){const{show:p,isSupported:v}=ge({title:"事項完成",body:o.value,icon:new URL(""+new URL("tomato-fe6b03eb.png",import.meta.url).href,self.location).href});v.value&&p()}S(),c.value=Array(26).fill().map(()=>Array(60).fill(!1)),s.value.length>0&&N()},w=I(()=>o.value.length>0?o.value:s.value.length>0?"點擊開始":"沒有事項"),R=I(()=>{const d=Math.floor(n.value/60).toString().padStart(2,"0"),p=(n.value%60).toString().padStart(2,"0");return d+":"+p});return(d,p)=>(P(),Z(ee,null,{default:m(()=>[f(re,{class:"main mt-5"},{default:m(()=>[f(h,{cols:"10"},{default:m(()=>[y("table",_e,[(P(),M(j,null,G(25,v=>y("tr",{key:v},[(P(),M(j,null,G(60,V=>y("td",{key:V,ref_for:!0,ref:`cell-${v}-${V}`,class:te({timm:!0}),style:ne(O.value[(25-v)*60+V-1])},null,4)),64))])),64))])]),_:1}),f(h,{cols:"2",class:"text-area"},{default:m(()=>[f(h,{cols:"12"},{default:m(()=>[he]),_:1}),f(h,{cols:"12"},{default:m(()=>[y("h1",ye,B(w.value),1)]),_:1}),f(h,{cols:"12"},{default:m(()=>[Se]),_:1}),f(h,{cols:"12"},{default:m(()=>[y("h1",be,B(R.value),1)]),_:1})]),_:1}),f(h,{cols:"12",class:"button-area"},{default:m(()=>[f(E,{variant:"text",icon:"mdi-play",disabled:l.value===i.COUNTING||x(o).length===0&&x(s).length===0,onClick:N,color:"#6e6e73",border:"1px solid black"},null,8,["disabled"]),f(E,{variant:"text",icon:"mdi-pause",disabled:l.value!==i.COUNTING,onClick:k,color:"#6e6e73"},null,8,["disabled"]),f(E,{variant:"text",icon:"mdi-skip-next",disabled:x(o).length===0,onClick:g,color:"#6e6e73"},null,8,["disabled"])]),_:1})]),_:1})]),_:1}))}},Ae=Y(we,[["__scopeId","data-v-534a2156"]]);export{Ae as default};
